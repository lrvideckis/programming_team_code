Note the memory is actually somewhere between nlogn/64, and nlogn. See my comment here https://github.com/lrvideckis/programming_team_code/issues/429#issue-1793021660
